# GRAILICE - GRAILICE

GRAILICE は、サイコロを振って数字カードを集めるシンプルなボードゲームです。

## ゲームの概要

2 人以上のプレイヤーで遊ぶゲームです。プレイヤーは順番にサイコロを振り、出た目の合計に対応する数字カードを獲得したり、他のプレイヤーの持つカードに対応する数字が出ると相手がアウトになるというルールです。

## ゲームのルール

1. ゲーム開始時、2〜12 の数字カードが場に置かれています。
2. プレイヤーは順番にサイコロを 2 つ振ります。
3. サイコロの目の合計に対応する数字カードが場にある場合、そのプレイヤーはそのカードを獲得します。
4. サイコロの目の合計に対応する数字カードを他のプレイヤーが持っている場合、そのカードを持っているプレイヤーはアウトとなります。アウト回数がカウントされます。
5. サイコロの目の合計に対応する数字カードを自分が持っている場合、セーフとなります。このとき、そのカードは前のプレイヤー（自分の前にサイコロを振ったプレイヤー）に渡ります。最初のプレイヤーの場合は最後のプレイヤーに渡ります。
6. 場のカードがなくなったらゲーム終了です。
7. ゲーム終了時に、各プレイヤーのアウト回数が表示されます。

## ゲームの流れ

1. プレイヤー名を入力してゲームを開始します。
2. 各プレイヤーは順番にサイコロを振ります。
3. サイコロを振った後、次のプレイヤーに交代します。
4. 全てのカードが場からなくなるまでゲームを続けます。
5. ゲーム終了時に各プレイヤーのアウト回数が表示されます。

## 技術的な実装

- Flutter フレームワークを使用したクロスプラットフォームアプリ
- Riverpod を使用した状態管理
- Freezed を使用した不変オブジェクトの実装
- GoRouter を使用したナビゲーション
- SharedPreferences を使用したゲーム状態の永続化

## 主な機能

- プレイヤー設定画面
- ゲーム画面（サイコロ、カード、プレイヤー情報の表示）
- ゲーム状態の保存と読み込み
- ゲーム終了時のアウト回数表示

## 特記事項

- 各プレイヤーは 1 ターンに 1 回だけサイコロを振ることができます。
- サイコロを振った後は「次のプレイヤー」ボタンを押して次のプレイヤーに交代します。
- セーフの場合、カードは前のプレイヤーに渡ります（循環）。
- アウト回数はゲーム中常に表示され、ゲーム終了時にまとめて表示されます。

## 技術スタック

- **UI/グラフィック**: Unity
- **アプリケーションロジック**: Flutter
- **広告**: Admob
- **ローカルストレージ**: SharedPreferences / Hive
- **プラットフォーム**: iOS/Android

## 開発環境のセットアップ

### 前提条件

- Flutter SDK (FVM で管理: バージョン 3.19.3)
- Unity 2022.3 以上
- Android Studio / Xcode

### Flutter セットアップ

1. FVM のインストール

```bash
brew tap leoafarias/fvm
brew install fvm
```

2. Flutter のインストールと設定

```bash
fvm install 3.19.3
fvm use 3.19.3
```

3. 依存関係のインストール

```bash
fvm flutter pub get
```

### Unity セットアップ

1. Unity Hub をインストール

   - [Unity Hub ダウンロードページ](https://unity.com/download)からダウンロード

2. Unity 2022.3 以上をインストール

   - Unity Hub から「インストール」→「エディターをインストール」
   - バージョン 2022.3 以上を選択
   - 「Android Build Support」と「iOS Build Support」を選択

3. Unity プロジェクトを開く
   - Unity Hub から「プロジェクト」→「開く」→「unity」ディレクトリを選択

## プロジェクト構造

```
GRAILICE/
├── lib/                      # Flutterソースコード
│   ├── application/          # ユースケース層
│   ├── domain/               # ドメイン層
│   ├── infrastructure/       # インフラストラクチャ層
│   ├── presentation/         # プレゼンテーション層
│   ├── common/               # 共通ユーティリティ
│   ├── config/               # 設定
│   ├── utils/                # ユーティリティ関数
│   └── main.dart             # エントリーポイント
│
└── unity/                    # Unityプロジェクト
    └── Assets/
        ├── Scenes/           # シーン
        ├── Prefabs/          # プレハブ
        ├── Scripts/          # スクリプト
        ├── Materials/        # マテリアル
        ├── Textures/         # テクスチャ
        └── Animations/       # アニメーション
```

## ビルドと実行

### Flutter アプリのビルド

```bash
# デバッグビルド
fvm flutter run

# リリースビルド（Android）
fvm flutter build apk --release

# リリースビルド（iOS）
fvm flutter build ios --release
```

### Unity のビルド

Unity エディタから「File」→「Build Settings」を開き、プラットフォームを選択してビルドします。

## 開発ガイドライン

詳細な開発ガイドラインは `.ai/flutter-development-setup.md` を参照してください。
